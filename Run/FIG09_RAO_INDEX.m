close all
clear all
warning off
%==========================================================================

%==========================================================================
%% Script to plot the RAO index of diversity
%--------------------------------------------------------------------------
% Writen by Iria Sala
% Created on 10.03.2025
%==========================================================================

%==========================================================================
%% Load Rao index data:
%==========================================================================
RAO = xlsread('Rao2D.csv');
%--------------------------------------------------------------------------
time = 1:365;
TIME = repmat(time,100,1);
%--------------------------------------------------------------------------
zdep = [-247.42,-242.33,-237.34,-232.44,-227.64,-222.93,-218.31,-213.77,...
        -209.32,-204.96,-200.67,-196.47,-192.34,-188.30,-184.32,-180.42,...
        -176.60,-172.84,-169.15,-165.53,-161.98,-158.49,-155.07,-151.70,...
        -148.40,-145.16,-141.97,-138.84,-135.77,-132.75,-129.79,-126.87,...
        -124.01,-121.20,-118.43,-115.72,-113.05,-110.42,-107.84,-105.30,...
        -102.80,-100.35,-97.934,-95.559,-93.221,-90.921,-88.657,-86.429,...
        -84.235,-82.075,-79.947,-77.852,-75.788,-73.754,-71.749,-69.774,...
        -67.826,-65.905,-64.011,-62.142,-60.298,-58.479,-56.682,-54.909,...
        -53.157,-51.427,-49.717,-48.027,-46.356,-44.704,-43.070,-41.453,...
        -39.852,-38.268,-36.698,-35.144,-33.603,-32.076,-30.562,-29.060,...
        -27.569,-26.090,-24.621,-23.162,-21.712,-20.271,-18.838,-17.413,...
        -15.994,-14.582,-13.176,-11.775,-10.378,-8.9862,-7.5976,-6.2121,...
        -4.8291,-3.4479,-2.0682,-0.68931];
ZDEP = repmat(zdep',1,365);
%==========================================================================

%==========================================================================
%% Plot time vectors:
%==========================================================================
Tvec = [1 32 60 91 121 152 182 213 244 274 305 335];       % Time ticks
Tout = {'J' 'F' 'M' 'A' 'M' 'J' 'J' 'A' 'S' 'O' 'N' 'D'};  % Time labels
%==========================================================================

%==========================================================================
%% FIGURE
%==========================================================================
make_it_tight = true;
% m = distance between subplots
% n = distance to bottom and upper edges
% p = distance to right and left edges
subplot = @(m,n,p) subtightplot (m, n, p, [0.01 0.01], [0.12 0.06], [0.12 0.04]);
if ~make_it_tight,  clear subplot;  end
%..........................................................................
Fig = figure;
set(gcf, 'Color','white');
set(Fig, 'Position',[900,150,600,400]);
%==========================================================================
subplot(1,1,1);
%..........................................................................
hold on
box on
%..........................................................................
pcolor(TIME,ZDEP,RAO');
shading flat
%..........................................................................
xlim([1 365]);
xlabel('Time (months)')
set(gca,'XTick',Tvec,'XTickLabel',Tout,'FontSize',11)
%..........................................................................
ylim([-250 0]);
ylabel('Depth (m)');
set(gca,'YTick',[-250:50:0],'YTickLabel',[-250:50:0],'FontSize',11)
%..........................................................................
colormap(jet);
caxis([0 0.25]);
h1 = colorbar('EastOutside');
% set(h1, 'Position',[.475 .55 .015 .38]);
set(h1,'FontSize',11);
% set(h1,'ytick',[0:0.5:3],'yticklabel',[0:0.5:3],'FontSize',11)
set(h1, 'YTickLabel', num2str(get(h1, 'YTick')', '%.2f'))
%..........................................................................
set(gca,'FontSize',11,'FontName','Arial');
%==========================================================================
%% Save figure:
%..........................................................................
set(gcf,'PaperPositionMode','auto');
print(gcf, '-dpng', 'FIG09_RAO_INDEX.png');
%--------------------------------------------------------------------------
print('FIG09_RAO_INDEX', '-depsc'); % Save as an EPS file
%--------------------------------------------------------------------------
% Get the current figure position in inches
fig = gcf;
fig.Units = 'inches';
figPosition = fig.Position;
%..........................................................................
% Set PaperSize to match the figure dimensions
set(gcf, 'PaperUnits', 'inches');
set(gcf, 'PaperSize', [figPosition(3) figPosition(4)]);
%..........................................................................
% Save the figure as a PDF using the print command
print(gcf, 'FIG09_RAO_INDEX.pdf', '-dpdf', '-bestfit');
%==========================================================================
return
