close all
clear all
warning off
%==========================================================================

%==========================================================================
%% Script to plot the fitness landscapes of the 1D model, obtained from 
% the R-script GMK98_fitness_Landscape.R
%--------------------------------------------------------------------------
% Writen by Iria Sala
% Created on 18.03.2024
%==========================================================================

%==========================================================================
%% Load data:
%==========================================================================
DATA = xlsread('phyto_fitness_landscape_summer.csv');
% Topt	CDiv	alphaChl	mu	QN	C2Chl
%--------------------------------------------------------------------------
CDIV = DATA(:,3); % Size (um)
TOPT = DATA(:,2); % Optimal temperature (degree C)
IOPT = DATA(:,4); % Light affinity (alphaChl, (m^{2} W^{-1} mol C g Chl^{-1} d^{-1}))
MU   = DATA(:,5); % Growth rate (d-1)
QN   = DATA(:,6); % QN (mol mol-1)
CC   = DATA(:,7); % Chl:C (g mol-1)
%--------------------------------------------------------------------------
ESD  = [ 0.5000000   0.6608104   0.8733407   1.1542251   1.5254479   2.0160635 ...
         2.6644714   3.5214206   4.6539824   6.1507997   8.1290243  10.7434871 ...
        14.1988152  18.7654485  24.8008057  32.7772590  43.3191049  57.2514270 ...
        75.6646728 100.0000000];
ESD_ = repmat(ESD,20,1); % Size range
%--------------------------------------------------------------------------
aCHL = [0.01831564; 0.02144840; 0.02511700; 0.02941308; 0.03444398; 0.04033538;...
        0.04723446; 0.05531358; 0.06477458; 0.07585381; 0.08882807; 0.10402148;...
        0.12181361; 0.14264897; 0.16704807; 0.19562046; 0.22907995; 0.26826245;...
        0.31414685; 0.36787944];
aCHL_ = repmat(aCHL,20,1); %alphaChl range
%==========================================================================

%==========================================================================
%% Data selection:
%==========================================================================
SEL = find(IOPT == 0.0758538081271346); % Constant light affinity
%--------------------------------------------------------------------------
XX_CDIVxTOPT = CDIV(SEL);
XX_CDIVxTOPT = reshape(ESD_,20,20);
%--------------------------------------------------------------------------
YY_CDIVxTOPT = TOPT(SEL);
YY_CDIVxTOPT = reshape(YY_CDIVxTOPT,20,20);
%--------------------------------------------------------------------------
MU_CDIVxTOPT = MU(SEL);
MU_CDIVxTOPT = reshape(MU_CDIVxTOPT,20,20);
%--------------------------------------------------------------------------
QN_CDIVxTOPT = QN(SEL);
QN_CDIVxTOPT = reshape(QN_CDIVxTOPT,20,20);
%--------------------------------------------------------------------------
CC_CDIVxTOPT = CC(SEL);
CC_CDIVxTOPT = reshape(CC_CDIVxTOPT,20,20);
%..........................................................................
clear SEL
%==========================================================================
SEL = find(TOPT == 30); % Constant optimal temperature
%--------------------------------------------------------------------------
XX_CDIVxIOPT = CDIV(SEL);
XX_CDIVxIOPT = reshape(ESD_,20,20);
%--------------------------------------------------------------------------
YY_CDIVxIOPT = IOPT(SEL);
YY_CDIVxIOPT = reshape(aCHL_,20,20);
%--------------------------------------------------------------------------
MU_CDIVxIOPT = MU(SEL);
MU_CDIVxIOPT = reshape(MU_CDIVxIOPT,20,20);
%--------------------------------------------------------------------------
QN_CDIVxIOPT = QN(SEL);
QN_CDIVxIOPT = reshape(QN_CDIVxIOPT,20,20);
%--------------------------------------------------------------------------
CC_CDIVxIOPT = CC(SEL);
CC_CDIVxIOPT = reshape(CC_CDIVxIOPT,20,20);
%..........................................................................
clear SEL
%==========================================================================
SEL = find(CDIV == 0.0293566573134334); % Constant size
%--------------------------------------------------------------------------
XX_TOPTxIOPT = TOPT(SEL);
XX_TOPTxIOPT = reshape(XX_TOPTxIOPT,20,20);
%--------------------------------------------------------------------------
YY_TOPTxIOPT = IOPT(SEL);
YY_TOPTxIOPT = reshape(YY_TOPTxIOPT,20,20);
%--------------------------------------------------------------------------
MU_TOPTxIOPT = MU(SEL);
MU_TOPTxIOPT = reshape(MU_TOPTxIOPT,20,20);
%--------------------------------------------------------------------------
QN_TOPTxIOPT = QN(SEL);
QN_TOPTxIOPT = reshape(QN_TOPTxIOPT,20,20);
%--------------------------------------------------------------------------
CC_TOPTxIOPT = CC(SEL);
CC_TOPTxIOPT = reshape(CC_TOPTxIOPT,20,20);
%..........................................................................
clear SEL
%==========================================================================


%==========================================================================
%% Figure:
%==========================================================================
make_it_tight = true;
% m = distance between subplots
% n = distance to bottom and top
% p = distance to left and right
subplot = @(m,n,p) subtightplot (m, n, p, [0.02 0.02], [0.10 0.05], [0.10 0.03]);
if ~make_it_tight,  clear subplot;  end
%..........................................................................
Fig = figure;
set(gcf, 'Color','white');
set(Fig, 'Position',[400,050,1000,900]);
%==========================================================================
F01 = subplot(3,3,1);
box on
grid on
%..........................................................................
pcolor(log10(XX_CDIVxTOPT),YY_CDIVxTOPT,MU_CDIVxTOPT);
shading interp
%..........................................................................
xlabel('ESD (\mum)'); 
set(gca,'XTick',[log10(0.50) log10(1.00) log10(3.00) log10(6.00) log10(10) log10(20) log10(50) log10(100)],...
        'XTickLabel',[0.50 1.00 3.00 6.00 10 20 50 100])
%..........................................................................
ylabel('T_{opt} (ºC)') 
ylim([0 30])
%..........................................................................
colormap(jet(28))
caxis([0 1.40]);
%..........................................................................
str = '(a) \mu (d^{-1})';
text(-0.20,28,str,'LineStyle','none','HorizontalAlignment','Left',...
                  'FontWeight', 'bold','Color','w','FontSize',11);
%..........................................................................
set(gca,'TickLength',[0.005, 0.005])
set(gca,'FontSize',11,'FontName','Arial'); 
%==========================================================================
F02 = subplot(3,3,2);
box on
grid on
%..........................................................................
pcolor(log10(XX_CDIVxIOPT),log10(YY_CDIVxIOPT),MU_CDIVxIOPT');
shading interp
%..........................................................................
xlabel('ESD (\mum)'); 
set(gca,'XTick',[log10(0.50) log10(1.00) log10(3.00) log10(6.00) log10(10) log10(20) log10(50) log10(100)],...
        'XTickLabel',[0.50 1.00 3.00 6.00 10 20 50 100])
%..........................................................................
% ylim([log10(0.01) log10(0.50)]) 
ylabel('\alpha^{Chl} (m^{2} W^{-1} mol C g Chl^{-1} d^{-1})')
set(gca,'YTick',[log10(0.01) log10(0.03) log10(0.06) log10(0.10) log10(0.20) log10(0.30) log10(0.50)],...
        'YTickLabel',[0.01 0.03 0.10 0.20 0.30 0.50])
%..........................................................................
colormap(jet(28))
caxis([0 1.40]);
%..........................................................................
str = '(d) \mu (d^{-1})'; 
text(-0.20,-0.53,str,'LineStyle','none','HorizontalAlignment','Left',...
                  'FontWeight', 'bold','Color','w','FontSize',11);
%..........................................................................
set(gca,'TickLength',[0.005, 0.005])
set(gca,'FontSize',11,'FontName','Arial'); 
%==========================================================================
F03 = subplot(3,3,3);
box on
grid on
%..........................................................................
pcolor(XX_TOPTxIOPT,log10(YY_TOPTxIOPT),MU_TOPTxIOPT);
shading interp
%..........................................................................
xlabel('T_{opt} (ºC)') ;
xlim([0 30])
%..........................................................................
ylabel('\alpha^{Chl} (m^{2} W^{-1} mol C g Chl^{-1} d^{-1})')
set(gca,'YTick',[log10(0.01) log10(0.03) log10(0.06) log10(0.10) log10(0.20) log10(0.30) log10(0.50)],...
        'YTickLabel',[0.01 0.03 0.10 0.20 0.30 0.50])
%..........................................................................
colormap(jet(28));
caxis([0 1.40]);
h1 = colorbar('EastOutside');
set(h1, 'Position', [.94 .71 .015 .24]);
set(h1, 'YTickLabel', num2str(get(h1, 'YTick')', '%.2f'))
% set(h1,'ytick',[0:0.1:1.4],'yticklabel',[0:0.1:0.5],'FontSize',11)
%..........................................................................
str = '(g) \mu (d^{-1})'; 
text(1.00,-0.53,str,'LineStyle','none','HorizontalAlignment','Left',...
                  'FontWeight', 'bold','Color','w','FontSize',11);
%..........................................................................
set(gca,'TickLength',[0.005, 0.005])
set(gca,'FontSize',11,'FontName','Arial'); 
%==========================================================================
F04 = subplot(3,3,4);
box on
grid on
%..........................................................................
pcolor(log10(XX_CDIVxTOPT),YY_CDIVxTOPT,QN_CDIVxTOPT');
shading interp
%..........................................................................
xlabel('ESD (\mum)'); 
set(gca,'XTick',[log10(0.50) log10(1.00) log10(3.00) log10(6.00) log10(10) log10(20) log10(50) log10(100)],...
        'XTickLabel',[0.50 1.00 3.00 6.00 10 20 50 100])
%..........................................................................
ylabel('T_{opt} (ºC)') 
ylim([0 30])
%..........................................................................
colormap(jet(28))
caxis([0 0.30]);
%..........................................................................
str = '(b) Q^{N} (mol mol^{-1})'; 
text(-0.20,28,str,'LineStyle','none','HorizontalAlignment','Left',...
                  'FontWeight', 'bold','Color','w','FontSize',11);
%..........................................................................
set(gca,'TickLength',[0.005, 0.005])
set(gca,'FontSize',11,'FontName','Arial'); 
%==========================================================================
F05 = subplot(3,3,5);
box on
grid on
%..........................................................................
pcolor(log10(XX_CDIVxIOPT),log10(YY_CDIVxIOPT),QN_CDIVxIOPT');
shading interp
%..........................................................................
xlabel('ESD (\mum)'); 
set(gca,'XTick',[log10(0.50) log10(1.00) log10(3.00) log10(6.00) log10(10) log10(20) log10(50) log10(100)],...
        'XTickLabel',[0.50 1.00 3.00 6.00 10 20 50 100])
%..........................................................................
ylabel('\alpha^{Chl} (m^{2} W^{-1} mol C g Chl^{-1} d^{-1})')
set(gca,'YTick',[log10(0.01) log10(0.03) log10(0.06) log10(0.10) log10(0.20) log10(0.30) log10(0.50)],...
        'YTickLabel',[0.01 0.03 0.10 0.20 0.30 0.50])
% ylim([log10(0.01) log10(0.50)])  
%..........................................................................
colormap(jet(28))
caxis([0 0.30]);
%..........................................................................
str = '(e) Q^{N} (mol mol^{-1})';
text(-0.20,-0.53,str,'LineStyle','none','HorizontalAlignment','Left',...
                  'FontWeight', 'bold','Color','w','FontSize',11);
%..........................................................................
set(gca,'TickLength',[0.005, 0.005])
set(gca,'FontSize',11,'FontName','Arial'); 
%==========================================================================
F06 = subplot(3,3,6);
box on
grid on
%..........................................................................
pcolor(XX_TOPTxIOPT,log10(YY_TOPTxIOPT),QN_TOPTxIOPT);
shading interp
%..........................................................................
xlabel('T_{opt} (ºC)') ;
xlim([0 30])
%..........................................................................
ylabel('\alpha^{Chl} (m^{2} W^{-1} mol C g Chl^{-1} d^{-1})')
set(gca,'YTick',[log10(0.01) log10(0.03) log10(0.06) log10(0.10) log10(0.20) log10(0.30) log10(0.50)],...
        'YTickLabel',[0.01 0.03 0.10 0.20 0.30 0.50])
% ylim([log10(0.01) log10(0.50)])  
%..........................................................................
colormap(jet(28));
caxis([0 0.30]);
h2 = colorbar('EastOutside');
set(h2, 'Position', [.94 .39 .015 .24]);
set(h2, 'YTickLabel', num2str(get(h2, 'YTick')', '%.2f'))
% set(h2,'ytick',[0:0.1:0.5],'yticklabel',[0:0.1:0.5],'FontSize',11)
%..........................................................................
str = '(h) Q^{N} (mol mol^{-1})'; 
text(1.00,-0.53,str,'LineStyle','none','HorizontalAlignment','Left',...
                  'FontWeight', 'bold','Color','w','FontSize',11);
%..........................................................................
set(gca,'TickLength',[0.005, 0.005])
set(gca,'FontSize',11,'FontName','Arial'); 
%==========================================================================
F07 = subplot(3,3,7);
box on
grid on
%..........................................................................
pcolor(log10(XX_CDIVxTOPT),YY_CDIVxTOPT,CC_CDIVxTOPT);
shading interp
%..........................................................................
xlabel('ESD (\mum)'); 
set(gca,'XTick',[log10(0.50) log10(1.00) log10(3.00) log10(6.00) log10(10) log10(20) log10(50) log10(100)],...
        'XTickLabel',[0.50 1.00 3.00 6.00 10 20 50 100])
%..........................................................................
ylabel('T_{opt} (ºC)') 
ylim([0 30])
%..........................................................................
colormap(jet(28))
caxis([0 0.04]);
%..........................................................................
str = '(c) Chl:C (g g^{-1})'; 
text(-0.20,28,str,'LineStyle','none','HorizontalAlignment','Left',...
                  'FontWeight', 'bold','Color','w','FontSize',11);
%..........................................................................
set(gca,'TickLength',[0.005, 0.005])
set(gca,'FontSize',11,'FontName','Arial'); 
%==========================================================================
F08 = subplot(3,3,8);
box on
grid on
%..........................................................................
pcolor(log10(XX_CDIVxIOPT),log10(YY_CDIVxIOPT),CC_CDIVxIOPT');
shading interp
%..........................................................................
xlabel('ESD (\mum)'); 
set(gca,'XTick',[log10(0.50) log10(1.00) log10(3.00) log10(6.00) log10(10) log10(20) log10(50) log10(100)],...
        'XTickLabel',[0.50 1.00 3.00 6.00 10 20 50 100])
%..........................................................................
ylabel('\alpha^{Chl} (m^{2} W^{-1} mol C g Chl^{-1} d^{-1})')
set(gca,'YTick',[log10(0.01) log10(0.03) log10(0.06) log10(0.10) log10(0.20) log10(0.30) log10(0.50)],...
        'YTickLabel',[0.01 0.03 0.10 0.20 0.30 0.50])
% ylim([log10(0.01) log10(0.50)])  
%..........................................................................
colormap(jet(28))
caxis([0 0.04]);
%..........................................................................
str = '(f) Chl:C (g g^{-1})';
text(-0.20,-0.53,str,'LineStyle','none','HorizontalAlignment','Left',...
                  'FontWeight', 'bold','Color','w','FontSize',11);
%..........................................................................
set(gca,'TickLength',[0.005, 0.005])
set(gca,'FontSize',11,'FontName','Arial'); 
%==========================================================================
F09 = subplot(3,3,9);
box on
grid on
%..........................................................................
pcolor(XX_TOPTxIOPT,log10(YY_TOPTxIOPT),CC_TOPTxIOPT);
shading interp
%..........................................................................
xlabel('T_{opt} (ºC)') ;
xlim([0 30])
%..........................................................................
ylabel('\alpha^{Chl} (m^{2} W^{-1} mol C g Chl^{-1} d^{-1})')
set(gca,'YTick',[log10(0.01) log10(0.03) log10(0.06) log10(0.10) log10(0.20) log10(0.30) log10(0.50)],...
        'YTickLabel',[0.01 0.03 0.10 0.20 0.30 0.50])
% ylim([log10(0.01) log10(0.50)])  
%..........................................................................
colormap(jet(28));
caxis([0 0.04]);
h3 = colorbar('EastOutside');
set(h3, 'Position', [.94 .07 .015 .24]);
set(h3,'ytick',[0:0.01:0.04],'yticklabel',[0:0.01:0.04])
set(h3, 'YTickLabel', num2str(get(h3, 'YTick')', '%.2f'))
%..........................................................................
str = '(i) Chl:C (g g^{-1})';
text(1.00,-0.53,str,'LineStyle','none','HorizontalAlignment','Left',...
                  'FontWeight', 'bold','Color','w','FontSize',11);
%..........................................................................
set(gca,'TickLength',[0.005, 0.005])
set(gca,'FontSize',11,'FontName','Arial'); 
%==========================================================================
% Subplots position
set(F01,'position',[0.06 0.71 0.24 0.24]);
set(F02,'position',[0.37 0.71 0.24 0.24]);
set(F03,'position',[0.68 0.71 0.24 0.24]);
set(F04,'position',[0.06 0.39 0.24 0.24]);
set(F05,'position',[0.37 0.39 0.24 0.24]);
set(F06,'position',[0.68 0.39 0.24 0.24]);
set(F07,'position',[0.06 0.07 0.24 0.24]);
set(F08,'position',[0.37 0.07 0.24 0.24]);
set(F09,'position',[0.68 0.07 0.24 0.24]);
%==========================================================================
%% Save figure:
%..........................................................................
set(gcf,'PaperPositionMode','auto');
print(gcf, '-dpng','FIG03_FitnessLandscapes.png');
%--------------------------------------------------------------------------
print('FIG03_FitnessLandscapes', '-depsc'); % Save as an EPS file
%--------------------------------------------------------------------------
% Get the current figure position in inches
fig = gcf;
fig.Units = 'inches';
figPosition = fig.Position;
%..........................................................................
% Set PaperSize to match the figure dimensions
set(gcf, 'PaperUnits', 'inches');
set(gcf, 'PaperSize', [figPosition(3) figPosition(4)]);
%..........................................................................
% Save the figure as a PDF using the print command
print(gcf, 'FIG03_FitnessLandscapes.pdf', '-dpdf', '-bestfit');
%==========================================================================
return
